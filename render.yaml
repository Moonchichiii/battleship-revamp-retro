services:
  - type: web
    name: battleship-revamp
    runtime: docker
    plan: free
    region: frankfurt

    envVars:
      - key: PORT
        value: 8000

      # Postgres connection string
      - key: DATABASE_URL
        fromDatabase:
          name: battleship-revamp-db
          property: connectionString

      # Secret key for sessions & signing
      - key: SECRET_KEY
        generateValue: true

      # Explicit environment marker
      - key: ENVIRONMENT
        value: production

      # DB_AUTO_CREATE="1" will create tables if they don't exist. 
      - key: DB_AUTO_CREATE
        value: "1"

      # SECURITY: Rate Limiting ON in production
      - key: DISABLE_RATE_LIMIT
        value: "0"

      # DATA INTEGRITY: Real email validation ON in production
      - key: EMAIL_SYNTAX_ONLY
        value: "0"

databases:
  - name: battleship-revamp-db
    plan: free
    databaseName: battleship_revamp
    user: battleship_user